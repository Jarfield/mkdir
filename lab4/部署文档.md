# 单机部署
- 前提：已经安装好了python3和pip
- 安装ray
```shell
pip install -U "ray[default]"
```
- 启动ray

可以在python交互界面中启动ray
```python
import ray
ray.init()
···
ray.shutdown()
```
也可以在命令行中启动ray cluster head
```shell
ray start --head --port=6379
```
- 查看dashboard

完成启动后，可以打开网页：http://127.0.0.1:8265



# 集群部署


# 基于docker的部署
可以采用ray提供的docker镜像进行部署，也可以自己构建镜像。这里介绍使用dockerfile构建镜像的方案。

## docker安装完成后换源

- 在配置文件 /etc/docker/daemon.json 中加入：

```json
{
  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn/"]
}
```
- 重启docker
```shell
sudo systemctl restart docker
```

## 准备构建目录和Dockerfile

```shell
root@LAPTOP-Q9CFOCTC ~/r/docker_test# tree .
.
├── Dockerfile
├── normal_random.py
└── ray_random.py

0 directories, 3 files
```

## 编写Dockerfile

注：建议合并 RUN 指令：每个 RUN 指令都会创建一个新的层，这可能会导致最终的镜像比实际需要的大。可以通过将多个命令合并到一个 RUN 指令中来减少层数。

```dockerfile
FROM ubuntu

WORKDIR /

COPY . /

RUN sed -i s/archive.ubuntu.com/mirrors.aliyun.com/g /etc/apt/sources.list &&\
    sed -i s/security.ubuntu.com/mirrors.aliyun.com/g /etc/apt/sources.list &&\
    apt-get update &&\
    apt-get install -y python3 python3-pip &&\
    rm -rf /var/lib/apt/lists/*

RUN pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple &&\
    pip install -U "ray[default]"

```



